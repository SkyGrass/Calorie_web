(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-1794"],{"5b90":function(e,t,n){"use strict";n.d(t,"c",function(){return r}),n.d(t,"b",function(){return i}),n.d(t,"a",function(){return o});var a=n("t3Un");function r(e){return Object(a.a)({url:"/record/getrecord",method:"get",params:e})}function i(e){return Object(a.a)({url:"/record/getmealrecord",method:"get",params:e})}function o(e){return Object(a.a)({url:"/record/getfavMeal",method:"get",params:e})}},IUXy:function(e,t,n){"use strict";n.r(t);var a=n("jWXv"),r=n.n(a),i=n("rfXi"),o=n.n(i),s=n("P2sY"),l=n.n(s),c=n("gDS+"),u=n.n(c),d=n("m1cH"),p=n.n(d),f=n("FyfS"),m=n.n(f),h=n("5b90"),v=n("ZySA"),w=n("Q4Eu"),g=(n("7Qib"),n("Mz3J")),y=n("Si9d"),b=n("F16w"),k=n("SID3"),_=n("Wgwc"),x=n.n(_),T=n("PbVA"),C={name:"calorieforadmin",components:{Pagination:g.a,FilenameOption:y.a,BookTypeOption:b.a},directives:{waves:v.a,permission:w.a},data:function(){return{tableKey:0,u8list:[],u8listCopy:[],list:null,total:0,listLoading:!1,index:0,listQuery:{keyword:"",date:[x()().startOf("month").format("YYYY-MM-DD"),x()().endOf("month").format("YYYY-MM-DD")]},pickerOptionsForDate:{shortcuts:[{text:"最近一周",onClick:function(e){var t=new Date,n=new Date;n.setTime(n.getTime()-6048e5),e.$emit("pick",[n,t])}},{text:"最近一个月",onClick:function(e){var t=new Date,n=new Date;n.setTime(n.getTime()-2592e6),e.$emit("pick",[n,t])}},{text:"最近三个月",onClick:function(e){var t=new Date,n=new Date;n.setTime(n.getTime()-7776e6),e.$emit("pick",[n,t])}}]},btnIsLoading:!1,downloadLoading:!1,filename:"",autoWidth:!0,bookType:"xlsx",spanArr:[],meals:[{label:"早餐",value:"1"},{label:"中餐",value:"2"},{label:"晚餐",value:"3"}],tipsData:[]}},computed:{maxheight:function(){return.6*window.innerHeight}},watch:{list:{handler:function(e,t){var n=this.list,a={},r=!0,i=!1,o=void 0;try{for(var s,l=m()(n);!(r=(s=l.next()).done);r=!0){var c=s.value.createdate;void 0===a[c]?a[c]=1:a[c]++}}catch(e){i=!0,o=e}finally{try{!r&&l.return&&l.return()}finally{if(i)throw o}}this.index=a},deep:!0}},methods:{judgeRole:function(){return"user"==[].concat(p()(this.$store.getters.roles)).shift()},getList:function(){var e=this;this.spanArr=[];var t=JSON.parse(u()(this.listQuery));if(delete t.date,null==this.listQuery.date)return this.$notify({title:"提示",message:"请先指定要查询的日期!",type:"warning",duration:2e3});this.listLoading=!0,Object(h.c)(l()({},t,{begindate:this.listQuery.date[0],enddate:this.listQuery.date[1]})).then(function(t){var n=t.data,a=n.data,r=n.state;n.message;"success"===r?(console.log(a),e.buildShowData(a),a.length<=0&&e.$notify({title:"提示",message:"没有查询到数据!",type:"warning",duration:2e3})):e.$notify({title:"提示",message:"没有查询到数据!",type:"warning",duration:2e3}),setTimeout(function(){e.listLoading=!1},0)})},buildShowData:function(e){var t=this,n=e.map(function(e){return e.createdate}),a=e.map(function(e){return e.cardno});n=o()(new r.a(n));var i=[],s=[];(a=o()(new r.a(a))).forEach(function(a){var r=e.filter(function(e){return e.cardno==a})[0].username;n.forEach(function(n){var o={username:r,createdate:n,cardno:a,tipsforbreakfast:"",tipsforlunch:"",tipsfordinner:""},l={username:r,value:[],label:n,cardno:a},c=e.filter(function(e){return e.createdate==n&&e.cardno==a});t.meals.forEach(function(e){var t=0;c.filter(function(t){return t.meal==e.value}).forEach(function(e){t=T.a(t,e.calorie),"1"==e.meal?o.tipsforbreakfast+=e.name+"(卡路里:"+e.calorie+");":"2"==e.meal?o.tipsforlunch+=e.name+"(卡路里:"+e.calorie+");":"3"==e.meal&&(o.tipsfordinner+="<span>"+e.name+"(卡路里:"+e.calorie+")</span> <br/>")}),1==e.value?o.breakfast=t:2==e.value?o.lunch=t:3==e.value&&(o.dinner=t)}),s.push(o),i.push(l)})}),this.list=s.map(function(e){return e.sum=T.a(e.breakfast,e.lunch,e.dinner),e}),this.tipsData=i},buildTips:function(e,t){var n=e.createdate,a=e.cardno,r=this.tipsData.filter(function(e){return e.label==n&&e.cardno==a});if("breakfast"==t){var i=r.filter(function(e){return"早餐"==e.value.meal});console.log(i)}return"1"},handleFilter:function(){this.getList()},handleExplore:function(){var e=this;if(!(this.list.length>0))return this.$notify({title:"错误",message:"没有数据可以导出",type:"error",duration:2e3});this.downloadLoading=!0,Promise.all([n.e("chunk-7a57"),n.e("chunk-3c5e"),n.e("chunk-6b3a")]).then(n.bind(null,"S/jZ")).then(function(t){var n=[].concat(p()(k.config)),a=[].concat(p()(k.config)).map(function(e){return e.prop}),r=e.list,i=e.formatJson(a,r);t.export_json_to_excel({header:n.map(function(e){return e.title}),data:i,filename:e.filename,autoWidth:!0,bookType:e.bookType}),e.downloadLoading=!1})},formatJson:function(e,t){return t.map(function(t){return e.map(function(e){return t[e]})})}},mounted:function(){"user"==[].concat(p()(this.$store.getters.roles)).shift()&&(this.listQuery.keyword=this.$store.getters.username)}},D=(n("d53B"),n("KHd+")),E=Object(D.a)(C,function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"app-container"},[n("div",{staticClass:"filter-container"},[n("el-row",{attrs:{span:24}},[n("el-col",[n("el-input",{staticClass:"filter-item",staticStyle:{width:"200px"},attrs:{placeholder:"卡号或者姓名",disabled:e.judgeRole(),clearable:""},nativeOn:{keyup:function(t){return"button"in t||!e._k(t.keyCode,"enter",13,t.key,"Enter")?e.handleFilter(t):null}},model:{value:e.listQuery.keyword,callback:function(t){e.$set(e.listQuery,"keyword",t)},expression:"listQuery.keyword"}}),e._v(" "),n("el-date-picker",{staticClass:"filter-item",attrs:{type:"daterange",align:"right","unlink-panels":"","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期","value-format":"yyyy-MM-dd","picker-options":e.pickerOptionsForDate},model:{value:e.listQuery.date,callback:function(t){e.$set(e.listQuery,"date",t)},expression:"listQuery.date"}}),e._v(" "),n("el-button",{directives:[{name:"waves",rawName:"v-waves"}],staticClass:"filter-item",attrs:{type:"primary",icon:"el-icon-search"},on:{click:e.handleFilter}},[e._v("搜索")]),e._v(" "),n("FilenameOption",{staticClass:"filter-item",model:{value:e.filename,callback:function(t){e.filename=t},expression:"filename"}}),e._v(" "),n("BookTypeOption",{staticClass:"filter-item",model:{value:e.bookType,callback:function(t){e.bookType=t},expression:"bookType"}}),e._v(" "),n("el-button",{directives:[{name:"waves",rawName:"v-waves"}],staticClass:"filter-item",attrs:{type:"primary",icon:"el-icon-download",loading:e.downloadLoading},on:{click:e.handleExplore}},[e._v("导出")])],1)],1)],1),e._v(" "),n("el-row",{attrs:{span:24}},[n("el-col",{attrs:{span:24}},[n("div",{staticClass:"claim_company"},[n("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],key:e.tableKey,staticStyle:{width:"100%"},attrs:{data:e.list,border:"","highlight-current-row":"",height:e.maxheight}},[n("el-table-column",{attrs:{label:"日期",width:"120px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("span",[e._v(e._s(t.row.createdate))])]}}])}),e._v(" "),n("el-table-column",{attrs:{label:"姓名",width:"80px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("span",[e._v(e._s(t.row.username))])]}}])}),e._v(" "),n("el-table-column",{attrs:{label:"早餐",width:"80px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-popover",{attrs:{trigger:"hover",placement:"right"}},[n("div",{staticClass:"tips"},[e._v(e._s(t.row.tipsforbreakfast))]),e._v(" "),n("div",{staticClass:"name-wrapper",attrs:{slot:"reference"},slot:"reference"},[n("span",{attrs:{size:"medium"}},[e._v(e._s(t.row.breakfast))])])])]}}])}),e._v(" "),n("el-table-column",{attrs:{label:"中餐",width:"80px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-popover",{attrs:{trigger:"hover",placement:"right"}},[n("div",{staticClass:"tips"},[e._v(e._s(t.row.tipsforlunch))]),e._v(" "),n("div",{staticClass:"name-wrapper",attrs:{slot:"reference"},slot:"reference"},[n("span",{attrs:{size:"medium"}},[e._v(e._s(t.row.lunch))])])])]}}])}),e._v(" "),n("el-table-column",{attrs:{label:"晚餐",width:"80px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-popover",{attrs:{trigger:"hover",placement:"right"}},[n("div",{staticClass:"tips"},[e._v(e._s(t.row.tipsfordinner))]),e._v(" "),n("div",{staticClass:"name-wrapper",attrs:{slot:"reference"},slot:"reference"},[n("span",{attrs:{size:"medium"}},[e._v(e._s(t.row.dinner))])])])]}}])}),e._v(" "),n("el-table-column",{attrs:{label:"三餐合计",width:"80px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("span",[e._v(e._s(t.row.sum))])]}}])})],1)],1)])],1)],1)},[],!1,null,null,null);E.options.__file="calorieforadmin.vue";t.default=E.exports},Q4Eu:function(e,t,n){"use strict";var a=n("Q2AE"),r={inserted:function(e,t,n){var r=t.value,i=a.a.getters&&a.a.getters.roles;if(!(r&&r instanceof Array&&r.length>0))throw new Error("need roles! Like v-permission=\"['admin','editor']\"");var o=r;i.some(function(e){return o.includes(e)})||e.parentNode&&e.parentNode.removeChild(e)}},i=function(e){e.directive("permission",r)};window.Vue&&(window.permission=r,Vue.use(i)),r.install=i;t.a=r},SID3:function(e,t){e.exports={config:[{title:"日期",prop:"createdate"},{title:"姓名",prop:"username"},{title:"卡号",prop:"cardno"},{title:"早餐",prop:"breakfast"},{title:"中餐",prop:"lunch"},{title:"晚餐",prop:"dinner"},{title:"三餐合计",prop:"sum"}]}},"T+9X":function(e,t,n){},Y5bG:function(e,t,n){"use strict";n.d(t,"a",function(){return r}),Math.easeInOutQuad=function(e,t,n,a){return(e/=a/2)<1?n/2*e*e+t:-n/2*(--e*(e-2)-1)+t};var a=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(e){window.setTimeout(e,1e3/60)};function r(e,t,n){var r=document.documentElement.scrollTop||document.body.parentNode.scrollTop||document.body.scrollTop,i=e-r,o=0;t=void 0===t?500:t;!function e(){o+=20,function(e){document.documentElement.scrollTop=e,document.body.parentNode.scrollTop=e,document.body.scrollTop=e}(Math.easeInOutQuad(o,r,i,t)),o<t?a(e):n&&"function"==typeof n&&n()}()}},ZySA:function(e,t,n){"use strict";var a=n("P2sY"),r=n.n(a),i=(n("jUE0"),{bind:function(e,t){e.addEventListener("click",function(n){var a=r()({},t.value),i=r()({ele:e,type:"hit",color:"rgba(0, 0, 0, 0.15)"},a),o=i.ele;if(o){o.style.position="relative",o.style.overflow="hidden";var s=o.getBoundingClientRect(),l=o.querySelector(".waves-ripple");switch(l?l.className="waves-ripple":((l=document.createElement("span")).className="waves-ripple",l.style.height=l.style.width=Math.max(s.width,s.height)+"px",o.appendChild(l)),i.type){case"center":l.style.top=s.height/2-l.offsetHeight/2+"px",l.style.left=s.width/2-l.offsetWidth/2+"px";break;default:l.style.top=(n.pageY-s.top-l.offsetHeight/2-document.documentElement.scrollTop||document.body.scrollTop)+"px",l.style.left=(n.pageX-s.left-l.offsetWidth/2-document.documentElement.scrollLeft||document.body.scrollLeft)+"px"}return l.style.backgroundColor=i.color,l.className="waves-ripple z-active",!1}},!1)}}),o=function(e){e.directive("waves",i)};window.Vue&&(window.waves=i,Vue.use(o)),i.install=o;t.a=i},d53B:function(e,t,n){"use strict";var a=n("T+9X");n.n(a).a},jUE0:function(e,t,n){}}]);